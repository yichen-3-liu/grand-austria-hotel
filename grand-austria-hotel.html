<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥¥åœ°åˆ©å¤§é¥­åº— - Grand Austria Hotel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #764ba2;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .player-indicator {
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: bold;
        }

        .player-tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .player-tab {
            padding: 12px 30px;
            background: #dfe6e9;
            border: 3px solid #b2bec3;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .player-tab.active {
            background: #74b9ff;
            border-color: #0984e3;
            transform: scale(1.1);
        }

        .player-tab:hover {
            background: #b2bec3;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .info-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .info-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #764ba2;
        }

        .dice-area {
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 10px;
        }

        .dice-area h2 {
            color: #d63031;
            margin-bottom: 15px;
            text-align: center;
        }

        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .dice {
            width: 70px;
            height: 70px;
            background: white;
            border: 3px solid #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .dice:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .dice.selected {
            background: #ffeaa7;
            border-color: #fdcb6e;
            transform: scale(1.1);
        }

        .dice.used {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .btn {
            padding: 12px 30px;
            font-size: 1em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: #00b894;
            color: white;
        }

        .btn-secondary {
            background: #0984e3;
            color: white;
        }

        .btn-danger {
            background: #d63031;
            color: white;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .hotel-board {
            margin-bottom: 30px;
        }

        .hotel-board h2 {
            color: #0984e3;
            margin-bottom: 15px;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .room {
            aspect-ratio: 1;
            background: #dfe6e9;
            border: 2px solid #636e72;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            padding: 5px;
        }

        .room:hover {
            background: #b2bec3;
            transform: scale(1.05);
        }

        .room.occupied {
            background: #74b9ff;
            border-color: #0984e3;
        }

        .room-number {
            font-size: 0.8em;
            color: #2d3436;
            margin-bottom: 5px;
        }

        .room-guest {
            font-size: 1.2em;
        }

        .guests-area {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .guests-area h2 {
            color: #6c5ce7;
            margin-bottom: 15px;
        }

        .guests-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .guest-card {
            background: white;
            border: 2px solid #6c5ce7;
            border-radius: 8px;
            padding: 15px;
            min-width: 150px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .guest-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .guest-card.selected {
            background: #a29bfe;
            border-color: #6c5ce7;
        }

        .guest-name {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2d3436;
        }

        .guest-requirements {
            font-size: 0.9em;
            color: #636e72;
        }

        .guest-reward {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #dfe6e9;
            font-weight: bold;
            color: #00b894;
        }

        .resources-area {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
            padding: 20px;
            background: #ffeaa7;
            border-radius: 10px;
        }

        .resource {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 2px solid #fdcb6e;
        }

        .resource-icon {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .resource-count {
            font-size: 1.2em;
            font-weight: bold;
            color: #e17055;
        }

        .log-area {
            margin-top: 20px;
            padding: 15px;
            background: #2d3436;
            color: #dfe6e9;
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid #636e72;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            text-align: center;
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #764ba2;
        }

        .modal-content p {
            margin-bottom: 20px;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ¨ å¥¥åœ°åˆ©å¤§é¥­åº—</h1>
        <p class="subtitle">Grand Austria Hotel - ç½‘é¡µç‰ˆ</p>

        <!-- æ¨¡å¼é€‰æ‹©ï¼ˆåˆå§‹æ˜¾ç¤ºï¼‰ -->
        <div id="modeSelection" style="text-align: center; margin: 30px 0;">
            <h2 style="margin-bottom: 20px;">é€‰æ‹©æ¸¸æˆæ¨¡å¼</h2>
            <button class="btn btn-primary" onclick="startGame(1)" style="margin: 0 10px;">å•äººæ¨¡å¼</button>
            <button class="btn btn-secondary" onclick="startGame(2)" style="margin: 0 10px;">åŒäººæ¨¡å¼</button>
        </div>

        <!-- æ¸¸æˆåŒºåŸŸï¼ˆåˆå§‹éšè—ï¼‰ -->
        <div id="gameArea" style="display: none;">
        
        <!-- å½“å‰ç©å®¶æŒ‡ç¤ºå™¨ -->
        <div class="player-indicator" id="playerIndicator">å½“å‰ç©å®¶ï¼šç©å®¶1 ğŸ®</div>

        <!-- ç©å®¶åˆ‡æ¢æ ‡ç­¾ -->
        <div class="player-tabs" id="playerTabs" style="display: none;">
            <div class="player-tab active" onclick="switchPlayerView(0)">ç©å®¶1 ğŸ‘¤</div>
            <div class="player-tab" onclick="switchPlayerView(1)">ç©å®¶2 ğŸ‘¥</div>
        </div>

        <!-- æ¸¸æˆä¿¡æ¯ -->
        <div class="game-info">
            <div class="info-item">
                <div class="info-label">å›åˆ</div>
                <div class="info-value" id="round">1</div>
            </div>
            <div class="info-item">
                <div class="info-label">é‡‘é’±</div>
                <div class="info-value" id="money">10</div>
            </div>
            <div class="info-item">
                <div class="info-label">åˆ†æ•°</div>
                <div class="info-value" id="score">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">å‘˜å·¥</div>
                <div class="info-value" id="staff">2</div>
            </div>
        </div>

        <!-- éª°å­åŒºåŸŸ -->
        <div class="dice-area">
            <h2>ğŸ² è¡ŒåŠ¨éª°å­</h2>
            <div class="dice-container" id="diceContainer"></div>
            <div class="action-buttons">
                <button class="btn btn-primary" id="rollDiceBtn" onclick="rollDice()">æŠ•æ·éª°å­</button>
                <button class="btn btn-secondary" id="useActionBtn" onclick="useSelectedDice()" disabled>ä½¿ç”¨é€‰ä¸­çš„éª°å­</button>
            </div>
        </div>

        <!-- èµ„æºåŒºåŸŸ -->
        <div class="resources-area">
            <div class="resource">
                <div class="resource-icon">â˜•</div>
                <div>å’–å•¡</div>
                <div class="resource-count" id="coffee">0</div>
            </div>
            <div class="resource">
                <div class="resource-icon">ğŸ°</div>
                <div>è›‹ç³•</div>
                <div class="resource-count" id="cake">0</div>
            </div>
            <div class="resource">
                <div class="resource-icon">ğŸ·</div>
                <div>çº¢é…’</div>
                <div class="resource-count" id="wine">0</div>
            </div>
            <div class="resource">
                <div class="resource-icon">ğŸ</div>
                <div>ä¸»é£Ÿ</div>
                <div class="resource-count" id="meal">0</div>
            </div>
        </div>

        <!-- å®¢äººåŒºåŸŸ -->
        <div class="guests-area">
            <h2>ğŸ‘¥ ç­‰å¾…çš„å®¢äºº</h2>
            <div class="guests-container" id="guestsContainer"></div>
            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="serveGuest()">æ¥å¾…é€‰ä¸­çš„å®¢äºº</button>
            </div>
        </div>

        <!-- é…’åº—æˆ¿é—´ -->
        <div class="hotel-board">
            <h2>ğŸ¨ é…’åº—æˆ¿é—´</h2>
            <div class="rooms-grid" id="roomsGrid"></div>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="action-buttons">
            <button class="btn btn-danger" onclick="endTurn()">ç»“æŸæˆ‘çš„å›åˆ</button>
            <button class="btn btn-secondary" onclick="resetGame()">é‡æ–°å¼€å§‹</button>
        </div>

        <!-- æ—¥å¿— -->
        <div class="log-area" id="logArea"></div>
        
        </div><!-- ç»“æŸ gameArea -->
    </div>

    <!-- æ¸¸æˆç»“æŸæ¨¡æ€æ¡† -->
    <div class="modal" id="gameOverModal">
        <div class="modal-content">
            <h2>ğŸ‰ æ¸¸æˆç»“æŸï¼</h2>
            <p id="finalScore"></p>
            <button class="btn btn-primary" onclick="resetGame()">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            mode: 1, // 1=å•äºº, 2=åŒäºº
            round: 1,
            maxRounds: 7,
            currentPlayer: 0, // å½“å‰ç©å®¶ç´¢å¼•
            viewingPlayer: 0, // å½“å‰æŸ¥çœ‹çš„ç©å®¶
            players: [
                {
                    name: 'ç©å®¶1',
                    money: 10,
                    score: 0,
                    staff: 2,
                    resources: { coffee: 0, cake: 0, wine: 0, meal: 0 },
                    rooms: [],
                    guests: [],
                    selectedGuest: null
                }
            ],
            dice: [],
            selectedDice: null,
            turnComplete: false
        };

        // å®¢äººæ¨¡æ¿
        const guestTemplates = [
            { name: 'å•†äºº', requirements: { coffee: 2, cake: 1 }, reward: 5, icon: 'ğŸ‘”' },
            { name: 'è´µæ—', requirements: { wine: 2, meal: 1 }, reward: 7, icon: 'ğŸ‘‘' },
            { name: 'è‰ºæœ¯å®¶', requirements: { coffee: 1, wine: 1 }, reward: 4, icon: 'ğŸ¨' },
            { name: 'æ—…è¡Œè€…', requirements: { cake: 1, meal: 1 }, reward: 4, icon: 'ğŸ’' },
            { name: 'æ”¿å®¢', requirements: { wine: 3 }, reward: 6, icon: 'ğŸ’¼' },
            { name: 'ä½œå®¶', requirements: { coffee: 3 }, reward: 5, icon: 'âœï¸' },
            { name: 'ç¾é£Ÿå®¶', requirements: { meal: 2, wine: 1 }, reward: 6, icon: 'ğŸ½ï¸' },
            { name: 'éŸ³ä¹å®¶', requirements: { coffee: 1, cake: 1, wine: 1 }, reward: 8, icon: 'ğŸµ' }
        ];

        // å¼€å§‹æ¸¸æˆ
        function startGame(mode) {
            gameState.mode = mode;
            
            // éšè—æ¨¡å¼é€‰æ‹©ï¼Œæ˜¾ç¤ºæ¸¸æˆåŒºåŸŸ
            document.getElementById('modeSelection').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            
            // å¦‚æœæ˜¯åŒäººæ¨¡å¼ï¼Œæ·»åŠ ç¬¬äºŒä¸ªç©å®¶
            if (mode === 2) {
                gameState.players.push({
                    name: 'ç©å®¶2',
                    money: 10,
                    score: 0,
                    staff: 2,
                    resources: { coffee: 0, cake: 0, wine: 0, meal: 0 },
                    rooms: [],
                    guests: [],
                    selectedGuest: null
                });
                document.getElementById('playerTabs').style.display = 'flex';
            }
            
            initGame();
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // ä¸ºæ¯ä¸ªç©å®¶åˆå§‹åŒ–æˆ¿é—´å’Œå®¢äºº
            gameState.players.forEach(player => {
                player.rooms = Array(12).fill(null).map((_, i) => ({
                    id: i + 1,
                    guest: null
                }));
                player.guests = [];
                generateGuestsForPlayer(player);
            });

            // æ¸²æŸ“æ¸¸æˆç•Œé¢
            renderGame();
            addLog('æ¸¸æˆå¼€å§‹ï¼æ¬¢è¿æ¥åˆ°å¥¥åœ°åˆ©å¤§é¥­åº—ï¼');
            if (gameState.mode === 2) {
                addLog('ğŸ® åŒäººæ¨¡å¼ï¼šç©å®¶è½®æµè¿›è¡Œå›åˆ');
            }
            addLog(`${getCurrentPlayer().name}ï¼ŒæŠ•æ·éª°å­å¼€å§‹ä½ çš„å›åˆå§ï¼`);
        }

        // è·å–å½“å‰ç©å®¶
        function getCurrentPlayer() {
            return gameState.players[gameState.currentPlayer];
        }

        // è·å–æŸ¥çœ‹ä¸­çš„ç©å®¶
        function getViewingPlayer() {
            return gameState.players[gameState.viewingPlayer];
        }

        // åˆ‡æ¢æŸ¥çœ‹çš„ç©å®¶
        function switchPlayerView(playerIndex) {
            gameState.viewingPlayer = playerIndex;
            renderGame();
            
            // æ›´æ–°æ ‡ç­¾æ ·å¼
            document.querySelectorAll('.player-tab').forEach((tab, index) => {
                tab.classList.toggle('active', index === playerIndex);
            });
        }

        // ä¸ºç©å®¶ç”Ÿæˆå®¢äºº
        function generateGuestsForPlayer(player) {
            const count = Math.min(4, 8 - player.guests.length);
            for (let i = 0; i < count; i++) {
                const template = guestTemplates[Math.floor(Math.random() * guestTemplates.length)];
                player.guests.push({
                    id: Date.now() + Math.random(),
                    ...template
                });
            }
        }

        // æŠ•æ·éª°å­
        function rollDice() {
            gameState.dice = Array(6).fill(0).map(() => ({
                value: Math.floor(Math.random() * 6) + 1,
                used: false
            }));
            gameState.selectedDice = null;
            gameState.turnComplete = false;
            
            addLog(`ğŸ² ${getCurrentPlayer().name}æŠ•æ·éª°å­å®Œæˆï¼`);
            renderDice();
            document.getElementById('rollDiceBtn').disabled = true;
        }

        // é€‰æ‹©éª°å­
        function selectDice(index) {
            if (gameState.dice[index].used) return;
            
            gameState.selectedDice = index;
            renderDice();
            document.getElementById('useActionBtn').disabled = false;
        }

        // ä½¿ç”¨é€‰ä¸­çš„éª°å­
        function useSelectedDice() {
            if (gameState.selectedDice === null) return;

            const player = getCurrentPlayer();
            const diceValue = gameState.dice[gameState.selectedDice].value;
            gameState.dice[gameState.selectedDice].used = true;

            // æ ¹æ®éª°å­ç‚¹æ•°è·å–èµ„æº
            const resourceTypes = ['coffee', 'cake', 'wine', 'meal'];
            if (diceValue <= 4) {
                const resource = resourceTypes[diceValue - 1];
                player.resources[resource] += 2;
                addLog(`âœ… ${player.name}ä½¿ç”¨éª°å­${diceValue}ï¼Œè·å¾—2ä¸ª${getResourceName(resource)}ï¼`);
            } else if (diceValue === 5) {
                player.money += 3;
                addLog(`âœ… ${player.name}ä½¿ç”¨éª°å­5ï¼Œè·å¾—3é‡‘é’±ï¼`);
            } else if (diceValue === 6) {
                player.staff += 1;
                addLog(`âœ… ${player.name}ä½¿ç”¨éª°å­6ï¼Œé›‡ä½£1åå‘˜å·¥ï¼`);
            }

            gameState.selectedDice = null;
            document.getElementById('useActionBtn').disabled = true;
            
            // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰éª°å­éƒ½ç”¨å®Œäº†
            if (gameState.dice.every(d => d.used)) {
                addLog(`â±ï¸ ${player.name}çš„æ‰€æœ‰éª°å­å·²ä½¿ç”¨å®Œæ¯•ï¼`);
                gameState.turnComplete = true;
            }

            renderGame();
        }

        // è·å–èµ„æºåç§°
        function getResourceName(resource) {
            const names = {
                coffee: 'å’–å•¡',
                cake: 'è›‹ç³•',
                wine: 'çº¢é…’',
                meal: 'ä¸»é£Ÿ'
            };
            return names[resource];
        }

        // é€‰æ‹©å®¢äºº
        function selectGuest(guestId) {
            const player = getCurrentPlayer();
            player.selectedGuest = guestId;
            renderGuests();
        }

        // æ¥å¾…å®¢äºº
        function serveGuest() {
            const player = getCurrentPlayer();
            
            if (!player.selectedGuest) {
                addLog('âš ï¸ è¯·å…ˆé€‰æ‹©ä¸€ä¸ªå®¢äººï¼');
                return;
            }

            const guest = player.guests.find(g => g.id === player.selectedGuest);
            if (!guest) return;

            // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„èµ„æº
            let canServe = true;
            for (const [resource, amount] of Object.entries(guest.requirements)) {
                if (player.resources[resource] < amount) {
                    canServe = false;
                    addLog(`âš ï¸ èµ„æºä¸è¶³ï¼éœ€è¦${amount}ä¸ª${getResourceName(resource)}`);
                }
            }

            if (!canServe) return;

            // æ£€æŸ¥æ˜¯å¦æœ‰ç©ºæˆ¿é—´
            const emptyRoom = player.rooms.find(r => r.guest === null);
            if (!emptyRoom) {
                addLog('âš ï¸ æ²¡æœ‰ç©ºæˆ¿é—´äº†ï¼');
                return;
            }

            // æ‰£é™¤èµ„æº
            for (const [resource, amount] of Object.entries(guest.requirements)) {
                player.resources[resource] -= amount;
            }

            // å®‰æ’å®¢äººå…¥ä½
            emptyRoom.guest = guest;
            player.score += guest.reward;
            
            addLog(`ğŸ‰ ${player.name}æˆåŠŸæ¥å¾…${guest.icon}${guest.name}ï¼Œè·å¾—${guest.reward}åˆ†ï¼`);

            // ç§»é™¤å®¢äºº
            player.guests = player.guests.filter(g => g.id !== player.selectedGuest);
            player.selectedGuest = null;

            // ç”Ÿæˆæ–°å®¢äºº
            if (player.guests.length < 4) {
                generateGuestsForPlayer(player);
            }

            renderGame();
        }

        // ç»“æŸç©å®¶çš„å›åˆ
        function endTurn() {
            const player = getCurrentPlayer();
            
            // å¦‚æœè¿˜æœ‰éª°å­æ²¡ç”¨å®Œï¼Œæç¤ºç©å®¶
            if (gameState.dice.length > 0 && !gameState.turnComplete) {
                if (!confirm('è¿˜æœ‰éª°å­æœªä½¿ç”¨ï¼Œç¡®å®šè¦ç»“æŸå›åˆå—ï¼Ÿ')) {
                    return;
                }
            }
            
            addLog(`âœ… ${player.name}çš„å›åˆç»“æŸ`);
            
            // åŒäººæ¨¡å¼ï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªç©å®¶
            if (gameState.mode === 2) {
                gameState.currentPlayer = (gameState.currentPlayer + 1) % 2;
                
                // å¦‚æœå›åˆ°ç©å®¶1ï¼Œè¯´æ˜ä¸€è½®ç»“æŸ
                if (gameState.currentPlayer === 0) {
                    endRound();
                } else {
                    // åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªç©å®¶
                    addLog(`\nğŸ”„ è½®åˆ°${getCurrentPlayer().name}`);
                    gameState.dice = [];
                    gameState.selectedDice = null;
                    document.getElementById('rollDiceBtn').disabled = false;
                    gameState.viewingPlayer = gameState.currentPlayer;
                    renderGame();
                }
            } else {
                // å•äººæ¨¡å¼ï¼šç›´æ¥ç»“æŸå›åˆ
                endRound();
            }
        }

        // ç»“æŸå›åˆ
        function endRound() {
            gameState.round++;
            
            if (gameState.round > gameState.maxRounds) {
                endGame();
                return;
            }

            // ä¸ºæ¯ä¸ªç©å®¶è®¡ç®—å›åˆå¥–åŠ±
            gameState.players.forEach(player => {
                const occupiedRooms = player.rooms.filter(r => r.guest !== null).length;
                const roundBonus = occupiedRooms * 2;
                player.money += roundBonus;
                player.score += Math.floor(occupiedRooms / 3);
                addLog(`ğŸ’° ${player.name}å…¥ä½å¥–åŠ±ï¼š${roundBonus}é‡‘é’±`);
            });

            addLog(`\nğŸ”„ å›åˆ${gameState.round - 1}ç»“æŸï¼`);
            
            // é‡ç½®éª°å­
            gameState.dice = [];
            gameState.selectedDice = null;
            gameState.currentPlayer = 0;
            document.getElementById('rollDiceBtn').disabled = false;

            renderGame();
            addLog(`\n--- å›åˆ ${gameState.round} å¼€å§‹ ---`);
            addLog(`${getCurrentPlayer().name}ï¼ŒæŠ•æ·éª°å­å¼€å§‹ä½ çš„å›åˆï¼`);
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            let resultText = 'ğŸŠ æ¸¸æˆç»“æŸï¼\n\n';
            
            // è®¡ç®—æ¯ä¸ªç©å®¶çš„æœ€ç»ˆå¾—åˆ†
            gameState.players.forEach(player => {
                const occupiedRooms = player.rooms.filter(r => r.guest !== null).length;
                const finalBonus = occupiedRooms * 3 + Math.floor(player.money / 2);
                player.score += finalBonus;
                
                resultText += `${player.name}:\n`;
                resultText += `  å¾—åˆ†ï¼š${player.score}åˆ†\n`;
                resultText += `  å…¥ä½æˆ¿é—´ï¼š${occupiedRooms}/12\n\n`;
                
                addLog(`${player.name}æœ€ç»ˆå¾—åˆ†ï¼š${player.score}åˆ†`);
            });
            
            // åŒäººæ¨¡å¼ï¼šåˆ¤æ–­èƒœè€…
            if (gameState.mode === 2) {
                const p1 = gameState.players[0];
                const p2 = gameState.players[1];
                if (p1.score > p2.score) {
                    resultText += `ğŸ† ${p1.name}è·èƒœï¼`;
                } else if (p2.score > p1.score) {
                    resultText += `ğŸ† ${p2.name}è·èƒœï¼`;
                } else {
                    resultText += 'ğŸ¤ å¹³å±€ï¼';
                }
            }

            document.getElementById('finalScore').textContent = resultText;
            document.getElementById('gameOverModal').classList.add('active');
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            gameState.mode = 1;
            gameState.round = 1;
            gameState.currentPlayer = 0;
            gameState.viewingPlayer = 0;
            gameState.players = [
                {
                    name: 'ç©å®¶1',
                    money: 10,
                    score: 0,
                    staff: 2,
                    resources: { coffee: 0, cake: 0, wine: 0, meal: 0 },
                    rooms: [],
                    guests: [],
                    selectedGuest: null
                }
            ];
            gameState.dice = [];
            gameState.selectedDice = null;
            gameState.turnComplete = false;

            document.getElementById('gameOverModal').classList.remove('active');
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('modeSelection').style.display = 'block';
            document.getElementById('playerTabs').style.display = 'none';
            document.getElementById('logArea').innerHTML = '';
        }

        // æ¸²æŸ“æ¸¸æˆç•Œé¢
        function renderGame() {
            const player = getViewingPlayer();
            const currentPlayer = getCurrentPlayer();
            
            // æ›´æ–°ç©å®¶æŒ‡ç¤ºå™¨
            document.getElementById('playerIndicator').textContent = 
                `å½“å‰å›åˆï¼š${currentPlayer.name} ğŸ® | æŸ¥çœ‹ï¼š${player.name}`;
            
            document.getElementById('round').textContent = gameState.round;
            document.getElementById('money').textContent = player.money;
            document.getElementById('score').textContent = player.score;
            document.getElementById('staff').textContent = player.staff;

            // æ¸²æŸ“èµ„æº
            for (const [resource, count] of Object.entries(player.resources)) {
                document.getElementById(resource).textContent = count;
            }

            renderDice();
            renderGuests();
            renderRooms();
        }

        // æ¸²æŸ“éª°å­
        function renderDice() {
            const container = document.getElementById('diceContainer');
            container.innerHTML = '';

            gameState.dice.forEach((dice, index) => {
                const diceEl = document.createElement('div');
                diceEl.className = 'dice';
                if (dice.used) diceEl.classList.add('used');
                if (gameState.selectedDice === index) diceEl.classList.add('selected');
                diceEl.textContent = dice.value;
                diceEl.onclick = () => selectDice(index);
                container.appendChild(diceEl);
            });
        }

        // æ¸²æŸ“å®¢äºº
        function renderGuests() {
            const container = document.getElementById('guestsContainer');
            container.innerHTML = '';
            const player = getViewingPlayer();

            player.guests.forEach(guest => {
                const card = document.createElement('div');
                card.className = 'guest-card';
                if (player.selectedGuest === guest.id) {
                    card.classList.add('selected');
                }
                
                const requirements = Object.entries(guest.requirements)
                    .map(([res, amt]) => `${getResourceName(res)}Ã—${amt}`)
                    .join(', ');

                card.innerHTML = `
                    <div class="guest-name">${guest.icon} ${guest.name}</div>
                    <div class="guest-requirements">éœ€è¦: ${requirements}</div>
                    <div class="guest-reward">+${guest.reward}åˆ†</div>
                `;
                card.onclick = () => selectGuest(guest.id);
                container.appendChild(card);
            });
        }

        // æ¸²æŸ“æˆ¿é—´
        function renderRooms() {
            const container = document.getElementById('roomsGrid');
            container.innerHTML = '';
            const player = getViewingPlayer();

            player.rooms.forEach(room => {
                const roomEl = document.createElement('div');
                roomEl.className = 'room';
                if (room.guest) {
                    roomEl.classList.add('occupied');
                }
                
                roomEl.innerHTML = `
                    <div class="room-number">æˆ¿é—´${room.id}</div>
                    <div class="room-guest">${room.guest ? room.guest.icon : 'ğŸšª'}</div>
                `;
                container.appendChild(roomEl);
            });
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(message) {
            const logArea = document.getElementById('logArea');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = message;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }

        // é¡µé¢åŠ è½½å®Œæˆåå‡†å¤‡æ¸¸æˆ
        // ä¸è‡ªåŠ¨å¯åŠ¨ï¼Œç­‰å¾…ç©å®¶é€‰æ‹©æ¨¡å¼
    </script>
</body>
</html>